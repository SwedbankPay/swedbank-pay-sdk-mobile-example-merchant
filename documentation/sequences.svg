<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2124px" preserveAspectRatio="none" style="width:1939px;height:2124px;" version="1.1" viewBox="0 0 1939 2124" width="1939px" zoomAndPan="magnify"><defs><filter height="300%" id="f182ht2mwx0hln" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f182ht2mwx0hln)" height="46.2656" style="stroke: #000000; stroke-width: 2.0;" width="701" x="23" y="103.2969"/><rect fill="#FFFFFF" filter="url(#f182ht2mwx0hln)" height="523.125" style="stroke: #000000; stroke-width: 2.0;" width="1895.5" x="13" y="205.6953"/><rect fill="#FFFFFF" filter="url(#f182ht2mwx0hln)" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="762" x="608" y="343.2266"/><rect fill="#FFFFFF" filter="url(#f182ht2mwx0hln)" height="88.3984" style="stroke: #000000; stroke-width: 2.0;" width="701" x="23" y="633.4219"/><rect fill="#FFFFFF" filter="url(#f182ht2mwx0hln)" height="88.3984" style="stroke: #000000; stroke-width: 2.0;" width="701" x="23" y="742.8203"/><rect fill="#FFFFFF" filter="url(#f182ht2mwx0hln)" height="88.3984" style="stroke: #000000; stroke-width: 2.0;" width="701" x="23" y="845.2188"/><rect fill="#FFFFFF" filter="url(#f182ht2mwx0hln)" height="1072.5156" style="stroke: #000000; stroke-width: 2.0;" width="1915.5" x="13" y="947.6172"/><rect fill="#FFFFFF" filter="url(#f182ht2mwx0hln)" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="762" x="608" y="971.75"/><rect fill="#FFFFFF" filter="url(#f182ht2mwx0hln)" height="88.3984" style="stroke: #000000; stroke-width: 2.0;" width="805" x="23" y="1319.2109"/><rect fill="#FFFFFF" filter="url(#f182ht2mwx0hln)" height="534.2578" style="stroke: #000000; stroke-width: 2.0;" width="1895.5" x="23" y="1421.6094"/><rect fill="#FFFFFF" filter="url(#f182ht2mwx0hln)" height="214.9297" style="stroke: #000000; stroke-width: 2.0;" width="864.5" x="1044" y="1675.6719"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="74" x2="74" y1="86.2969" y2="2037.1328"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="666" x2="666" y1="86.2969" y2="2037.1328"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1286" x2="1286" y1="86.2969" y2="2037.1328"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1806.5" x2="1806.5" y1="86.2969" y2="2037.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="76" x="33" y="82.9951">Mobile App</text><ellipse cx="74" cy="13" fill="#FEFECE" filter="url(#f182ht2mwx0hln)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M74,21 L74,48 M61,29 L87,29 M74,48 L61,63 M74,48 L87,63 " fill="none" filter="url(#f182ht2mwx0hln)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="76" x="33" y="2049.1279">Mobile App</text><ellipse cx="74" cy="2062.4297" fill="#FEFECE" filter="url(#f182ht2mwx0hln)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M74,2070.4297 L74,2097.4297 M61,2078.4297 L87,2078.4297 M74,2097.4297 L61,2112.4297 M74,2097.4297 L87,2112.4297 " fill="none" filter="url(#f182ht2mwx0hln)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f182ht2mwx0hln)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="618" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="625" y="70.9951">Mobile SDK</text><rect fill="#FEFECE" filter="url(#f182ht2mwx0hln)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="618" y="2036.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="625" y="2056.1279">Mobile SDK</text><rect fill="#FEFECE" filter="url(#f182ht2mwx0hln)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="144" x="1212" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="130" x="1219" y="70.9951">Merchant Backend</text><rect fill="#FEFECE" filter="url(#f182ht2mwx0hln)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="144" x="1212" y="2036.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="130" x="1219" y="2056.1279">Merchant Backend</text><rect fill="#FEFECE" filter="url(#f182ht2mwx0hln)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="179" x="1715.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="165" x="1722.5" y="70.9951">Swedbank Pay Backend</text><rect fill="#FEFECE" filter="url(#f182ht2mwx0hln)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="179" x="1715.5" y="2036.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="165" x="1722.5" y="2056.1279">Swedbank Pay Backend</text><path d="M23,103.2969 L103,103.2969 L103,110.2969 L93,120.2969 L23,120.2969 L23,103.2969 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="46.2656" style="stroke: #000000; stroke-width: 2.0;" width="701" x="23" y="103.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="35" x="38" y="116.3638">once</text><polygon fill="#A80036" points="654,137.5625,664,141.5625,654,145.5625,658,141.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="74" x2="660" y1="141.5625" y2="141.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="350" x="81" y="136.4966">Configure merchant backend URL and custom headers</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="74" x2="116" y1="177.6953" y2="177.6953"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="116" x2="116" y1="177.6953" y2="190.6953"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="75" x2="116" y1="190.6953" y2="190.6953"/><polygon fill="#A80036" points="85,186.6953,75,190.6953,85,194.6953,81,190.6953" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="261" x="81" y="172.6294">Prepare merchant specific payment data</text><path d="M13,205.6953 L77,205.6953 L77,212.6953 L67,222.6953 L13,222.6953 L13,205.6953 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="523.125" style="stroke: #000000; stroke-width: 2.0;" width="1895.5" x="13" y="205.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="28" y="218.7622">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="131" x="92" y="217.9058">[Identified Payment]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="74" x2="116" y1="243.9609" y2="243.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="116" x2="116" y1="243.9609" y2="256.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="75" x2="116" y1="256.9609" y2="256.9609"/><polygon fill="#A80036" points="85,252.9609,75,256.9609,85,260.9609,81,256.9609" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="379" x="81" y="238.895">Get customer's country; also e-mail and phone if applicable</text><polygon fill="#A80036" points="654,282.0938,664,286.0938,654,290.0938,658,286.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="74" x2="660" y1="286.0938" y2="286.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="488" x="81" y="281.0278">Initialize payment component with customer info and merchant specific data</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="74" x2="116" y1="315.2266" y2="315.2266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="116" x2="116" y1="315.2266" y2="328.2266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="75" x2="116" y1="328.2266" y2="328.2266"/><polygon fill="#A80036" points="85,324.2266,75,328.2266,85,332.2266,81,328.2266" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="172" x="81" y="310.1606">Show payment component</text><path d="M608,343.2266 L728,343.2266 L728,350.2266 L718,360.2266 L608,360.2266 L608,343.2266 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="762" x="608" y="343.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="75" x="623" y="356.2935">cacheable</text><polygon fill="#A80036" points="1274,377.4922,1284,381.4922,1274,385.4922,1278,381.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="666" x2="1280" y1="381.4922" y2="381.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="673" y="376.4263">GET {entrypoint}</text><polygon fill="#A80036" points="677,406.625,667,410.625,677,414.625,673,410.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="671" x2="1285" y1="410.625" y2="410.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="177" x="683" y="405.5591">consumers, paymentorders</text><polygon fill="#A80036" points="1274,442.7578,1284,446.7578,1274,450.7578,1278,446.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="666" x2="1280" y1="446.7578" y2="446.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="312" x="673" y="441.6919">POST {consumers}, consumerCountryCode, etc.</text><polygon fill="#A80036" points="1795,471.8906,1805,475.8906,1795,479.8906,1799,475.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1286" x2="1801" y1="475.8906" y2="475.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="327" x="1293" y="470.8247">POST /psp/consumers, consumerCountryCode, etc.</text><polygon fill="#A80036" points="1297,501.0234,1287,505.0234,1297,509.0234,1293,505.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1291" x2="1806" y1="505.0234" y2="505.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="1303" y="499.9575">token, operations</text><polygon fill="#A80036" points="677,530.1563,667,534.1563,677,538.1563,673,534.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="671" x2="1285" y1="534.1563" y2="534.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="683" y="529.0903">operations</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="666" x2="708" y1="563.2891" y2="563.2891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="708" x2="708" y1="563.2891" y2="576.2891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="667" x2="708" y1="576.2891" y2="576.2891"/><polygon fill="#A80036" points="677,572.2891,667,576.2891,677,580.2891,673,576.2891" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="606" x="673" y="558.2231">Compose web page with embedded view-consumer-identification link, and show it in a web view</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="666" x2="708" y1="605.4219" y2="605.4219"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="708" x2="708" y1="605.4219" y2="618.4219"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="667" x2="708" y1="618.4219" y2="618.4219"/><polygon fill="#A80036" points="677,614.4219,667,618.4219,677,622.4219,673,618.4219" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="673" y="600.356">onConsumerIdentified</text><path d="M23,633.4219 L93,633.4219 L93,640.4219 L83,650.4219 L23,650.4219 L23,633.4219 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="88.3984" style="stroke: #000000; stroke-width: 2.0;" width="701" x="23" y="633.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="38" y="646.4888">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="181" x="108" y="645.6323">[Store Consumer Reference]</text><polygon fill="#A80036" points="85,667.6875,75,671.6875,85,675.6875,81,671.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="79" x2="665" y1="671.6875" y2="671.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="91" y="666.6216">consumerProfileRef</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="74" x2="116" y1="700.8203" y2="700.8203"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="116" x2="116" y1="700.8203" y2="713.8203"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="75" x2="116" y1="713.8203" y2="713.8203"/><polygon fill="#A80036" points="85,709.8203,75,713.8203,85,717.8203,81,713.8203" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="293" x="81" y="695.7544">Store consumerProfileRef for future payments</text><path d="M23,742.8203 L87,742.8203 L87,749.8203 L77,759.8203 L23,759.8203 L23,742.8203 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="88.3984" style="stroke: #000000; stroke-width: 2.0;" width="701" x="23" y="742.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="38" y="755.8872">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="189" x="102" y="755.0308">[Stored Consumer Reference]</text><polygon fill="#A80036" points="654,777.0859,664,781.0859,654,785.0859,658,781.0859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="74" x2="660" y1="781.0859" y2="781.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="568" x="81" y="776.02">Initialize payment component with stored consumerProfileRef and merchant specific data</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="74" x2="116" y1="810.2188" y2="810.2188"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="116" x2="116" y1="810.2188" y2="823.2188"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="75" x2="116" y1="823.2188" y2="823.2188"/><polygon fill="#A80036" points="85,819.2188,75,823.2188,85,827.2188,81,823.2188" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="172" x="81" y="805.1528">Show payment component</text><path d="M23,845.2188 L87,845.2188 L87,852.2188 L77,862.2188 L23,862.2188 L23,845.2188 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="88.3984" style="stroke: #000000; stroke-width: 2.0;" width="701" x="23" y="845.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="38" y="858.2856">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="142" x="102" y="857.4292">[Anonymous Payment]</text><polygon fill="#A80036" points="654,879.4844,664,883.4844,654,887.4844,658,883.4844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="74" x2="660" y1="883.4844" y2="883.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="368" x="81" y="878.4185">Initialize payment component with merchant specific data</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="74" x2="116" y1="912.6172" y2="912.6172"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="116" x2="116" y1="912.6172" y2="925.6172"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="75" x2="116" y1="925.6172" y2="925.6172"/><polygon fill="#A80036" points="85,921.6172,75,925.6172,85,929.6172,81,925.6172" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="172" x="81" y="907.5513">Show payment component</text><path d="M13,947.6172 L123,947.6172 L123,954.6172 L113,964.6172 L13,964.6172 L13,947.6172 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1072.5156" style="stroke: #000000; stroke-width: 2.0;" width="1915.5" x="13" y="947.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="65" x="28" y="960.6841">Payment</text><path d="M608,971.75 L728,971.75 L728,978.75 L718,988.75 L608,988.75 L608,971.75 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="762" x="608" y="971.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="75" x="623" y="984.8169">cacheable</text><polygon fill="#A80036" points="1274,1006.0156,1284,1010.0156,1274,1014.0156,1278,1010.0156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="666" x2="1280" y1="1010.0156" y2="1010.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="673" y="1004.9497">GET {entrypoint}</text><polygon fill="#A80036" points="677,1035.1484,667,1039.1484,677,1043.1484,673,1039.1484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="671" x2="1285" y1="1039.1484" y2="1039.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="177" x="683" y="1034.0825">consumers, paymentorders</text><polygon fill="#A80036" points="1274,1071.2813,1284,1075.2813,1274,1079.2813,1278,1075.2813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="666" x2="1280" y1="1075.2813" y2="1075.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="384" x="673" y="1070.2153">POST {paymentorders}, consumerProfileRef, merchantData</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1286" x2="1328" y1="1104.4141" y2="1104.4141"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1328" x2="1328" y1="1104.4141" y2="1117.4141"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1287" x2="1328" y1="1117.4141" y2="1117.4141"/><polygon fill="#A80036" points="1297,1113.4141,1287,1117.4141,1297,1121.4141,1293,1117.4141" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="507" x="1293" y="1099.3481">Parse merchantData to prepare paymentorder, add consumerProfileRef if given</text><polygon fill="#A80036" points="1795,1142.5469,1805,1146.5469,1795,1150.5469,1799,1146.5469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1286" x2="1801" y1="1146.5469" y2="1146.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="1293" y="1141.481">POST /psp/paymentorders, paymentorder</text><polygon fill="#A80036" points="1297,1171.6797,1287,1175.6797,1297,1179.6797,1293,1175.6797" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1291" x2="1806" y1="1175.6797" y2="1175.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="1303" y="1170.6138">paymentorder, operations</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1286" x2="1328" y1="1219.9453" y2="1219.9453"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1328" x2="1328" y1="1219.9453" y2="1232.9453"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1287" x2="1328" y1="1232.9453" y2="1232.9453"/><polygon fill="#A80036" points="1297,1228.9453,1287,1232.9453,1297,1236.9453,1293,1232.9453" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="357" x="1293" y="1199.7466">Store the Swedbank URL referring to the payment order</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="401" x="1293" y="1214.8794">Create a Merchant Backend URL to refer to this payment order</text><polygon fill="#A80036" points="677,1258.0781,667,1262.0781,677,1266.0781,673,1262.0781" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="671" x2="1285" y1="1262.0781" y2="1262.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="278" x="683" y="1257.0122">url (the Merchant Backend one), operations</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="666" x2="708" y1="1291.2109" y2="1291.2109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="708" x2="708" y1="1291.2109" y2="1304.2109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="667" x2="708" y1="1304.2109" y2="1304.2109"/><polygon fill="#A80036" points="677,1300.2109,667,1304.2109,677,1308.2109,673,1304.2109" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="547" x="673" y="1286.145">Compose web page with embedded view-paymentorder link, and show it in a web view</text><path d="M23,1319.2109 L87,1319.2109 L87,1326.2109 L77,1336.2109 L23,1336.2109 L23,1319.2109 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="88.3984" style="stroke: #000000; stroke-width: 2.0;" width="805" x="23" y="1319.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="38" y="1332.2778">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="102" y="1331.4214">[Success]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="666" x2="708" y1="1357.4766" y2="1357.4766"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="708" x2="708" y1="1357.4766" y2="1370.4766"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="667" x2="708" y1="1370.4766" y2="1370.4766"/><polygon fill="#A80036" points="677,1366.4766,667,1370.4766,677,1374.4766,673,1370.4766" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="673" y="1352.4106">onPaymentCompleted</text><polygon fill="#A80036" points="85,1395.6094,75,1399.6094,85,1403.6094,81,1399.6094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="79" x2="665" y1="1399.6094" y2="1399.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="91" y="1394.5435">Payment state: Success</text><path d="M23,1421.6094 L87,1421.6094 L87,1428.6094 L77,1438.6094 L23,1438.6094 L23,1421.6094 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="534.2578" style="stroke: #000000; stroke-width: 2.0;" width="1895.5" x="23" y="1421.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="38" y="1434.6763">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="55" x="102" y="1433.8198">[Failure]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="666" x2="708" y1="1459.875" y2="1459.875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="708" x2="708" y1="1459.875" y2="1472.875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="667" x2="708" y1="1472.875" y2="1472.875"/><polygon fill="#A80036" points="677,1468.875,667,1472.875,677,1476.875,673,1472.875" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="673" y="1454.8091">onPaymentFailed</text><polygon fill="#A80036" points="85,1498.0078,75,1502.0078,85,1506.0078,81,1502.0078" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="79" x2="665" y1="1502.0078" y2="1502.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="91" y="1496.9419">Payment state: Failure</text><polygon fill="#A80036" points="654,1527.1406,664,1531.1406,654,1535.1406,658,1531.1406" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="74" x2="660" y1="1531.1406" y2="1531.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="81" y="1526.0747">Get failure reason</text><polygon fill="#A80036" points="1274,1556.2734,1284,1560.2734,1274,1564.2734,1278,1560.2734" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="666" x2="1280" y1="1560.2734" y2="1560.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="673" y="1555.2075">GET {url}</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1286" x2="1328" y1="1589.4063" y2="1589.4063"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1328" x2="1328" y1="1589.4063" y2="1602.4063"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1287" x2="1328" y1="1602.4063" y2="1602.4063"/><polygon fill="#A80036" points="1297,1598.4063,1287,1602.4063,1297,1606.4063,1293,1602.4063" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="220" x="1293" y="1584.3403">Retrieve stored the Swedbank URL</text><polygon fill="#A80036" points="1795,1627.5391,1805,1631.5391,1795,1635.5391,1799,1631.5391" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1286" x2="1801" y1="1631.5391" y2="1631.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="1293" y="1626.4731">GET {paymentorder.id}</text><polygon fill="#A80036" points="1297,1656.6719,1287,1660.6719,1297,1664.6719,1293,1660.6719" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1291" x2="1806" y1="1660.6719" y2="1660.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="1303" y="1655.606">paymentorder, operations</text><path d="M1044,1675.6719 L1264,1675.6719 L1264,1682.6719 L1254,1692.6719 L1044,1692.6719 L1044,1675.6719 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="214.9297" style="stroke: #000000; stroke-width: 2.0;" width="864.5" x="1044" y="1675.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="175" x="1059" y="1688.7388">Retrieve Failure Reason</text><path d="M1054,1697.8047 L1054,1722.8047 L1514,1722.8047 L1514,1707.8047 L1504,1697.8047 L1054,1697.8047 " fill="#FBFB77" filter="url(#f182ht2mwx0hln)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1504,1697.8047 L1504,1707.8047 L1514,1707.8047 L1504,1697.8047 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="439" x="1060" y="1714.8716">N.B. The example does not implement this part at the time of writing</text><polygon fill="#A80036" points="1795,1749.0703,1805,1753.0703,1795,1757.0703,1799,1753.0703" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1286" x2="1801" y1="1753.0703" y2="1753.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="243" x="1293" y="1748.0044">GET {paymentorder.currentPayment}</text><polygon fill="#A80036" points="1297,1778.2031,1287,1782.2031,1297,1786.2031,1293,1782.2031" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1291" x2="1806" y1="1782.2031" y2="1782.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="57" x="1303" y="1777.1372">payment</text><polygon fill="#A80036" points="1795,1807.3359,1805,1811.3359,1795,1815.3359,1799,1811.3359" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1286" x2="1801" y1="1811.3359" y2="1811.3359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="1293" y="1806.27">GET {payment.transactions.id}</text><polygon fill="#A80036" points="1297,1836.4688,1287,1840.4688,1297,1844.4688,1293,1840.4688" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1291" x2="1806" y1="1840.4688" y2="1840.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="1303" y="1835.4028">transactions</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1286" x2="1328" y1="1869.6016" y2="1869.6016"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1328" x2="1328" y1="1869.6016" y2="1882.6016"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1287" x2="1328" y1="1882.6016" y2="1882.6016"/><polygon fill="#A80036" points="1297,1878.6016,1287,1882.6016,1297,1886.6016,1293,1882.6016" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="228" x="1293" y="1864.5356">Find failedReason from transactions</text><polygon fill="#A80036" points="677,1914.7344,667,1918.7344,677,1922.7344,673,1918.7344" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="671" x2="1285" y1="1918.7344" y2="1918.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="227" x="683" y="1913.6685">url, state, failureReason, operations</text><polygon fill="#A80036" points="85,1943.8672,75,1947.8672,85,1951.8672,81,1947.8672" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="79" x2="665" y1="1947.8672" y2="1947.8672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="91" y="1942.8013">failureReason</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="74" x2="116" y1="1999.1328" y2="1999.1328"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="116" x2="116" y1="1999.1328" y2="2012.1328"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="75" x2="116" y1="2012.1328" y2="2012.1328"/><polygon fill="#A80036" points="85,2008.1328,75,2012.1328,85,2016.1328,81,2012.1328" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="255" x="81" y="1978.9341">Remove payment component from view</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="81" y="1994.0669">Display payment result</text><!--MD5=[63ae01bdc45503b0b1fe7506d01b37fa]
@startuml
actor "Mobile App" as App
participant "Mobile SDK" as SDK
participant "Merchant Backend" as Merx
participant "Swedbank Pay Backend" as Swed

group once
  App -> SDK : Configure merchant backend URL and custom headers
end

App -> App : Prepare merchant specific payment data

alt Identified Payment
  App -> App : Get customer's country; also e-mail and phone if applicable
  App -> SDK : Initialize payment component with customer info and merchant specific data
  App -> App : Show payment component

  group cacheable
    SDK -> Merx : GET {entrypoint}
    SDK <- Merx : consumers, paymentorders
  end

  SDK -> Merx : POST {consumers}, consumerCountryCode, etc.
  Merx -> Swed : POST /psp/consumers, consumerCountryCode, etc.
  Merx <- Swed : token, operations
  SDK <- Merx : operations

  SDK -> SDK : Compose web page with embedded view-consumer-identification link, and show it in a web view
  SDK -> SDK : onConsumerIdentified

  opt Store Consumer Reference
    App <- SDK : consumerProfileRef
    App -> App : Store consumerProfileRef for future payments
  end
end

alt Stored Consumer Reference
  App -> SDK : Initialize payment component with stored consumerProfileRef and merchant specific data
  App -> App : Show payment component
end

alt Anonymous Payment
  App -> SDK : Initialize payment component with merchant specific data
  App -> App : Show payment component
end

group Payment

  group cacheable
    SDK -> Merx : GET {entrypoint}
    SDK <- Merx : consumers, paymentorders
  end

  SDK -> Merx : POST {paymentorders}, consumerProfileRef, merchantData
  Merx -> Merx : Parse merchantData to prepare paymentorder, add consumerProfileRef if given
  Merx -> Swed : POST /psp/paymentorders, paymentorder
  Merx <- Swed : paymentorder, operations
  Merx -> Merx : Store the Swedbank URL referring to the payment order\nCreate a Merchant Backend URL to refer to this payment order
  SDK <- Merx: url (the Merchant Backend one), operations
  SDK -> SDK : Compose web page with embedded view-paymentorder link, and show it in a web view

  alt Success
    SDK -> SDK : onPaymentCompleted
    App <- SDK : Payment state: Success
  end
  alt Failure
    SDK -> SDK : onPaymentFailed
    App <- SDK : Payment state: Failure
    App -> SDK : Get failure reason
    SDK -> Merx : GET {url}
    Merx -> Merx : Retrieve stored the Swedbank URL
    Merx -> Swed : GET {paymentorder.id}
    Merx <- Swed : paymentorder, operations
    group Retrieve Failure Reason
      note over Merx : N.B. The example does not implement this part at the time of writing
      Merx -> Swed : GET {paymentorder.currentPayment}
      Merx <- Swed : payment
      Merx -> Swed : GET {payment.transactions.id}
      Merx <- Swed : transactions
      Merx -> Merx : Find failedReason from transactions
    end
    SDK <- Merx : url, state, failureReason, operations
    App <- SDK : failureReason
  end
  App -> App : Remove payment component from view\nDisplay payment result

end
@enduml

PlantUML version 1.2019.12(Sun Nov 03 10:24:54 UTC 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.7.0_25-b15
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>